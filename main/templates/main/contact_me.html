{% extends 'main/base.html' %}
{% load static %}
{% block extra_css%}
<link rel="stylesheet" href="{% static 'css/contact_me.css' %}">
{% endblock %}
{% block title %}Contact Me{% endblock %}
{% block content %}
  <section class="contact-section">
    <h1>Contact Me</h1>
    <p>For any inquieries, questions, or to schedule a 
      session with me, please fill out the form below and follow my Instagram!
    </p>
    <div class="contactform-container">
        <form id="contactform" action="https://api.web3forms.com/submit" method="POST">
          
          <!-- Web3Forms Access Key -->
          <input type="hidden" name="access_key" value="3e2edaf8-ec04-402c-82bb-584e26bca779">

          <input type="hidden" name="from_name" value="JPTraining Contact Form">

          <!-- (Optional) Auto-response subject line -->
          <input type="hidden" name="subject" value="JPT Contact Form - New Message">

          <!-- Honeypot field (spam trap) -->
          <input type="checkbox" name="botcheck" style="display:none">

          <div class="form-group">
            <label for="name">Name *</label>
            <input type="text" id="name" name="name" required>
            <div class="error" id="nameError"></div>
          </div>

          <div class="form-group">
            <label for="email">Email *</label>
            <input type="email" id="email" name="email" required>
            <div class="error" id="emailError"></div>
          </div>

          <div class="form-group">
            <label for="phonenumber">Phone Number *</label>
            <input type="text" id="phonenumber" name="Phone Number" required>
            <div class="error" id="phoneError"></div>
          </div>

          <div class="form-group">
            <label for="message">Message *</label>
            <textarea id="message" name="message" required></textarea>
            <div class="error" id="messageError"></div>
          </div>

          <button type="submit" class="btn">Send Message</button>
          <div class="success" id="successMsg"></div>

        </form>
      <br>

      <!-- Success Modal -->
      <div id="successModal" class="modal-overlay">
        <div class="modal-box">
          <div class="modal-icon">✔</div>
          <h2>Message Sent!</h2>
          <p>Your message has been sent successfully. I’ll get back to you soon.</p>
          <button id="closeModalBtn" class="modal-btn">Close</button>
        </div>
      </div>

      <!-- LightWidget WIDGET -->
      <script src="https://cdn.lightwidget.com/widgets/lightwidget.js"></script><iframe src="https://cdn.lightwidget.com/widgets/483a151824a45167a4cd75ab3bb1f4cc.html" scrolling="no" allowtransparency="true" class="lightwidget-widget" style="width:100%;border:0;overflow:hidden;"></iframe>
    </div>
  </section>

<script>
document.getElementById("contactform").addEventListener("submit", async function(e) {
    e.preventDefault();

    const form = this;
    const modal = document.getElementById("successModal");

    const formData = new FormData(form);

    const response = await fetch("https://api.web3forms.com/submit", {
        method: "POST",
        body: formData
    });

    const result = await response.json();

    if (result.success) {
        form.reset();
        modal.classList.add("show");   // <-- ONLY shows after submit
    } else {
        alert("Something went wrong. Please try again.");
    }
});

// Close modal
document.getElementById("closeModalBtn").addEventListener("click", () => {
    document.getElementById("successModal").classList.remove("show");
});
</script>
{% endblock %}